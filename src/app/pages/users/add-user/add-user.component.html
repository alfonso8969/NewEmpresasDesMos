<div class="page-wrapper">
  <!-- ============================================================== -->
  <!-- Container fluid  -->
  <!-- ============================================================== -->
  <div class="container-fluid animated fadeIn">
    <!-- ============================================================== -->
    <!-- Bread crumb and right sidebar toggle -->
    <!-- ============================================================== -->
    <div class="row page-titles">
      <div class="col-md-5 align-self-center">
        <h3 class="text-themecolor">Registrar usuario</h3>
      </div>
      <div class="">

      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div>
            <h3 class="card-title p-1">Solicitud de datos del usuario</h3>
            <cite class="card-title p-1">los campos marcados con * son obligatorios</cite>
            <button type="button" matTooltip="Limpiar el formulario" class="btn btn-default d-inline float-right mx-3"
              (click)="cleanForm()">Limpiar
              formulario
              <i class="fa fa-trash-o" aria-hidden="true"></i>
            </button>
          </div>
          <div class="card-body">
            <div class="form-body">
              <hr>
              <form [formGroup]="addUserForm" (ngSubmit)="addUser()" novalidate autocomplete="off">
                <div class="row p-t-20">
                  <div class="col-md-6">
                    <div id="div-img-user" class="text-center">
                      <img id="img-user" src="./assets/images/icon/staff.png" height="200px" width="200px"
                        alt="This is a small profile image"><br>
                      <input accept="image/png,image/jpeg,image/jpg" formControlName="userimg" type="file"
                        name="userimg" id="userimg" class="inputfile" (change)='uploadFile($event)'>
                      <label class="label-control d-block text-light" for="userimg">
                        <span class="file-button">
                          <i class="fa fa-upload" aria-hidden="true"></i>
                          Seleccione imagen
                        </span>
                      </label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mt-5">
                      <label for="nombre" class="control-label">* Nombre</label>
                      <input formControlName="nombre" id="nombre" name="nombre" type="text" class="form-control"
                        placeholder="Nombre completo">
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('nombre')?.invalid && addUserForm.get('nombre')?.touched">
                        El <strong>nombre es</strong> requerido
                      </span>
                    </div>
                    <div class="form-group">
                      <label for="apellidos" class="control-label">* Apellidos</label>
                      <input formControlName="apellidos" id="apellidos" name="apellidos" type="text"
                        class="form-control" placeholder="Apellidos">
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('apellidos')?.invalid && addUserForm.get('apellidos')?.touched">
                        Los <strong>apellidos son</strong> requeridos
                      </span>
                    </div>
                  </div>
                </div>
                <div class="row mt-5">
                  <div class="col-md-4">
                    <div class="form-group">
                      <label for="telefono" class="control-label">* Teléfono</label>
                      <input formControlName="telefono" type="number" name="telefono" id="telefono" class="form-control"
                        placeholder="9999999" maxlength="9">
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('telefono')?.invalid && addUserForm.get('telefono')?.touched && !addUserForm.get('telefono')!.errors!['pattern']">
                        El <strong>teléfono </strong>es requerido
                      </span>
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('telefono')!.errors != null && addUserForm.get('telefono')!.errors!['pattern'] && addUserForm.get('telefono')?.touched">
                        El <strong>Teléfono</strong> no es válido, debe ser 99999999
                      </span>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group">
                      <label for="email" class="control-label">* Email</label>
                      <input formControlName="email" type="email" class="form-control" placeholder="Email" id="email"
                        name="email">
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('email')?.invalid && addUserForm.get('email')?.touched && !addUserForm.get('email')!.errors!['pattern']">
                        El <strong>email es </strong>requerido
                      </span>
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('email')!.errors != null && addUserForm.get('email')!.errors!['pattern'] && addUserForm.get('email')?.touched">
                        El <strong>email</strong> no es válido
                      </span>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group">
                      <label for="rol" class="control-label">* Rol</label>
                      <select formControlName="rol" name="rol" id="rol" class="form-control w-100">
                        <option [ngValue]=0 selected>Seleccione rol</option>
                        <option [ngValue]=1>Administrador</option>
                        <option [ngValue]=2>Usuario</option>
                        <option [ngValue]=3>SuperAdmin</option>
                      </select>
                    </div>
                    <span class="err text-danger"
                      *ngIf="addUserForm.get('rol')?.invalid && addUserForm.get('rol')?.touched">
                      El <strong>rol es</strong> requerido
                    </span>
                    <span class="err text-danger"
                      *ngIf="addUserForm.get('rol')?.touched && addUserForm.get('rol')?.value == 0">
                      El <strong>rol es</strong> requerido
                    </span>
                  </div>
                </div>
                <div class="row mt-5">
                  <div class="col-md-4">
                    <div class="form-group">
                      <label for="newPassword" class="control-label">* Nueva contraseña</label>
                      <input formControlName="newPassword" type="password" name="newPassword" id="newPassword"
                        class="form-control" placeholder="contraseña nueva" maxlength="10" minlength="6"
                        autocomplete="new-password">
                      <i class="far fa-eye" style="margin-left: -30px;cursor: pointer; color: #045FB4"
                        id="toggleNewPassword"></i>
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('newPassword')?.invalid && addUserForm.get('newPassword')?.touched && !addUserForm.get('newPassword')!.errors!['pattern']">
                        La <strong>contraseña</strong> es requerida
                      </span>
                      <span class="err text-danger" newPassword
                        *ngIf="addUserForm.get('newPassword')!.errors != null && addUserForm.get('newPassword')!.errors!['pattern'] && addUserForm.get('newPassword')?.touched">
                        La <strong>contraseña</strong> no es válida, debe contener
                        <pre>
                        - 10 caracteres max
                        - 6 caracteres min
                        - 1 mayúscula
                        - 1 minúscula
                        - 1 número
                        - 1 caracter especial
                      </pre>
                      </span>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group">
                      <label for="rol" class="control-label">*
                        Escriba de nuevo la contraseña</label>
                      <input formControlName="comparePasswords" type="password" class="form-control"
                        placeholder="contraseña nueva" id="comparePasswords" name="comparePasswords" maxlength="10"
                        minlength="6" autocomplete="new-password">
                      <i class="far fa-eye" style=" margin-left: -30px;  cursor: pointer; color: #045FB4"
                        id="toggleCompPassword"></i>
                        <span class="err text-danger"
                        *ngIf="addUserForm.get('comparePasswords')?.invalid && addUserForm.get('comparePasswords')?.touched && !addUserForm.get('comparePasswords')!.errors!['pattern']">
                        La <strong>contraseña</strong> es requerida
                      </span>
                      <span class="err text-danger"
                        *ngIf="addUserForm.get('comparePasswords')!.errors != null && addUserForm.get('comparePasswords')!.errors!['pattern'] && addUserForm.get('comparePasswords')?.touched">
                        La <strong>contraseña</strong> no es válida, debe contener
                        <pre>
                          - 10 caracteres max
                          - 6 caracteres min
                          - 1 mayúscula
                          - 1 minúscula
                          - 1 número
                          - 1 caracter especial
                        </pre>
                      </span>
                      <span class="err text-danger"
                        *ngIf="(addUserForm.get('newPassword')!.valid && addUserForm.get('comparePasswords')!.valid) && (addUserForm.get('newPassword')!.value != addUserForm.get('comparePasswords')!.value)">
                        Las <strong>contraseñas </strong>no coinciden
                      </span>
                    </div>
                  </div>
                </div>
                <div class="form-actions mb-5">
                  <button type="submit" [disabled]="addUserForm.invalid || isDisabled() || (addUserForm.get('newPassword')!.value != addUserForm.get('comparePasswords')!.value)"
                    class="btn-primary button d-inline">
                    <span
                      [matTooltip]="addUserForm.invalid || isDisabled() || (addUserForm.get('newPassword')!.value != addUserForm.get('comparePasswords')!.value) ? 'Faltan campos obligatorios' : 'Guardar datos usuario'"
                      [matTooltipPosition]="'below'" aria-label="Botón que guarda la información sobre el usuario"
                      MAT_STRATEGY>Guardar
                    </span>
                    <i class="fa fa-save p-1"></i>
                  </button>

                </div>
                <!-- <p>{{ getFormValidationErrors(addUserForm) }}</p> -->
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
